# Stress-Detection-Using-Machine-Learning-Techniques
This project implements a wrist-based stress detection system using machine-learning methods.  
It was developed as a *Graduation Project at King Saud University – College of Applied Computer Sciences, under the supervision of **Dr. Mnahi Rubiaan Alqahtani*.

The system analyzes physiological signals from the *WESAD* dataset and uses a *CatBoost classifier* to determine whether a user is stressed or not based on sliding windows of sensor data.  
The full pipeline includes *feature extraction, a **FastAPI backend, and a **React frontend* for real-time interaction.

---

##  Overview

The stress-detection model uses wrist-based physiological signals:

| Signal | Description |
|--------|-------------|
| *BVP* | Blood Volume Pulse (used to estimate heart rate and HRV) |
| *EDA* | Electrodermal Activity (strong stress indicator) |
| *TEMP* | Skin Temperature |
| *ACC_x, ACC_y, ACC_z* | Accelerometer movement data |

###  Sliding Window Approach  
- Each prediction uses a *6-second window*  
- *50% overlap* for smoother transitions  
- Features extracted per window include:  
  - Statistical features (mean, std, min/max, skewness, kurtosis)  
  - Frequency-domain features  
  - EDA-specific peaks  
  - HRV metrics derived from BVP  
  - Movement energy from accelerometer  

###  Machine-Learning Model  
- Trained using *CatBoost*, achieving high accuracy  
- Trained on labeled segments (stress vs non-stress) from WESAD  
- Exported as .cbm model for deployment  


---

# Model Performance

**Accuracy:** `0.9746300211416491`

### Classification Report

| Class                | Precision | Recall | F1-Score | Support |
| -------------------- | --------- | ------ | -------- | ------- |
| **0 (Not Stressed)** | 0.98      | 0.98   | 0.98     | 326     |
| **1 (Stressed)**     | 0.95      | 0.97   | 0.96     | 147     |

**Overall Accuracy:** 0.97
**Macro Average:** Precision 0.97 • Recall 0.97 • F1-Score 0.97
**Weighted Average:** Precision 0.97 • Recall 0.97 • F1-Score 0.97



### Confusion Matrix

|              | Predicted 0 | Predicted 1 |
| ------------ | ----------- | ----------- |
| **Actual 0** | 319         | 7           |
| **Actual 1** | 5           | 142         |

---


##  Backend (FastAPI)

The backend provides real-time stress prediction.

*Responsibilities include:*
- Loading the trained CatBoost model
- Receiving 6 raw values from the frontend:
  - BVP, EDA, TEMP, ACC_x, ACC_y, ACC_z  
- Reconstructing a *synthetic 6-second window*  
- Extracting features using the same pipeline as training  
- Returning:
  - Stress status (STRESSED / NOT STRESSED)  
  - Stress probability  
  - Generated advice (based on physiological indicators)

---

##  Frontend (React)

The React frontend provides:
- A simple interface where users/employees enter vital readings  
- Real-time stress detection results  
- Display of advice generated by the AI model  
- Smooth interaction with the FastAPI backend  

---

##  Technologies Used

- *CatBoost* → machine-learning classification  
- *Python + FastAPI* → backend and model serving  
- *React* → frontend UI  
- *WESAD Dataset* → training and evaluation  

---
##  Chatbot

The chatbot provides short, controlled responses and explains stress-related metrics such as:

- Body Temperature  
- Electrodermal Activity (EDA)  
- Blood Volume Pulse (BVP)  
- Movement Activity  


 Tech Stack

- Node.js  
- Express.js  
- Ollama (local LLM engine)  
- Llama 3.2 model  


 How It Works

**Note:**  
This backend handles *only* the chatbot logic and LLM responses.  
The frontend (chat interface) is managed by another team member and communicates with this backend through **HTTP POST → /chat**.

The server receives a user message → builds a strict prompt → sends it to Ollama Llama 3.2 → gets a short controlled reply → returns it to the client.

 Files Included

- **server.js** → Main backend server  
- **package.json** → Project dependencies & scripts  
- **package-lock.json** → Dependency lock file  

---

##  Project Members

| Name | Role |
|------|------|
| *Khaled Thamer Alhassan* | Machine Learning Engineer|
| *Abdulrahman Mohammed Alajlan* | Frontend Developer |
| *Abdulelah Majed Alsalem* | Chatbot Developer |

---

##  Academic Information

- *University:* King Saud University  
- *College:* College of Applied Computer Sciences  
- *Course:* Graduation Project  
- *Supervisor:* Dr. Mnahi Rubiaan Alqahtani  

---

##  Purpose

This project demonstrates how wearable sensor data combined with machine-learning techniques can be used to classify stress levels.  
It supports real-time stress awareness and highlights the practical potential of physiological computing in modern applications.
